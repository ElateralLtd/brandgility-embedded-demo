"use strict";function _newArrowCheck(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}function _classPrivateFieldGet(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");var i=t.get(e);return i.get?i.get.call(e):i.value}function _classPrivateFieldSet(e,t,i){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");var a=t.get(e);if(a.set)a.set.call(e,i);else{if(!a.writable)throw new TypeError("attempted to set read only private field");a.value=i}return i}exports.__esModule=!0,exports.default=void 0;var BrandgilityEmbeddedApi=function(){function e(e){var t=this;_handlersByAction.set(this,{writable:!0,value:null}),_targetWindow.set(this,{writable:!0,value:null}),_identityKey.set(this,{writable:!0,value:null}),_handleMessage.set(this,{writable:!0,value:function(e){var i=this;_newArrowCheck(this,t);var a=e.source===_classPrivateFieldGet(this,_targetWindow),n=Boolean(e.data)&&e.data.identityKey===_classPrivateFieldGet(this,_identityKey);a&&n&&(_classPrivateFieldGet(this,_handlersByAction).has(e.data.action)?_classPrivateFieldGet(this,_handlersByAction).get(e.data.action).forEach(function(t){_newArrowCheck(this,i),t(e.data.payload)}.bind(this)):console.warn('BrandgilityEmbeddedApi: no handler was defined for "'+e.data.action+'" action'))}.bind(this)}),_classPrivateFieldSet(this,_handlersByAction,new Map),_classPrivateFieldSet(this,_targetWindow,e),_classPrivateFieldSet(this,_identityKey,"@BrandgilityEmbeddedApi"),window.addEventListener("message",_classPrivateFieldGet(this,_handleMessage))}var t=e.prototype;return t.on=function(e,t){var i=_classPrivateFieldGet(this,_handlersByAction).get(e)||[];_classPrivateFieldGet(this,_handlersByAction).set(e,[].concat(i,[t]))},t.emit=function(e,t){_classPrivateFieldGet(this,_targetWindow).postMessage({identityKey:_classPrivateFieldGet(this,_identityKey),action:e,payload:t},"*")},t.destroy=function(){window.removeEventListener("message",_classPrivateFieldGet(this,_handleMessage))},e}(),_handlersByAction=new WeakMap,_targetWindow=new WeakMap,_identityKey=new WeakMap,_handleMessage=new WeakMap,_default=BrandgilityEmbeddedApi;exports.default=_default;
